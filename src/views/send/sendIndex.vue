<template>  <div class="box-send">    <div class="box-send-title">      <a-textarea        v-model:value="title"        placeholder="请输入标题/关键词/描述......"        :auto-size="{ minRows: 2, maxRows: 5 }"      />      <a-button        type="primary"        @click="handleSend"        >发布</a-button      >    </div>    <div class="box-send-content">      <v-md-editor        v-model="text"        height="400px"        @copy-code-success="handleCopyCodeSuccess"      ></v-md-editor>    </div>    <div class="box-send-upload">      <a-upload-dragger        :fileList="fileList"        name="file"        :multiple="true"        :before-upload="beforeUpload"        @remove="handleRemove"      >        <p class="ant-upload-drag-icon">          <inbox-outlined></inbox-outlined>        </p>        <p class="ant-upload-text">点击选择或拖拽文件到这里上传</p>      </a-upload-dragger>    </div>    <a-button      type="primary"      @click="handleUpload"      >上传</a-button    >  </div></template><script setup>import { ref } from 'vue'// import VueMarkdownEditor, { xss } from '@kangc/v-md-editor'import { message } from '@utils/globalFun'import apis from '@http/index'import { InboxOutlined } from '@ant-design/icons-vue'let text = ref('')let title = ref('')const fileList = ref([])// const uploading = ref(false);function handleCopyCodeSuccess() {  message.success('复制成功！')}const handleSend = async () => {  let params = {    title: title.value,    content: text.value  }  console.log(params)  if (!params.title) {    message.error('请输入标题！')    return  }  if (!params.content) {    message.error('请输入内容！')    return  }  let imgArr = []  if (fileList.value.length > 0) {    imgArr = await handleUpload()    console.log(imgArr)  }  try {    params.image = imgArr    let res = await apis.sendAdd(params)    console.log(res)    if (res.code === 200 && res.data) {      message.success(res.message)      title.value = ''      text.value = ''    } else {      message.success(res.message)    }  } catch (error) {    message.error(error)  }}const handleRemove = file => {  const index = fileList.value.indexOf(file)  const newFileList = fileList.value.slice()  newFileList.splice(index, 1)  fileList.value = newFileList}const beforeUpload = file => {  fileList.value = [...fileList.value, file]  return false}const handleUpload = async () => {  if (fileList.value.length === 0) {    return ''  }  const formData = new FormData()  fileList.value.forEach(file => {    formData.append('file', file)  })  // uploading.value = true;  if (fileList.value.length > 1) {    formData.append('uploadType', 'more')  }  let imgArr = []  try {    let resUpload = await apis.sendUpload(formData)    let { code, data } = resUpload    if (code === 200 && data) {      if (Array.isArray(data)) {        imgArr = data      } else {        imgArr.push(data)      }    }    return imgArr  } catch (error) {    // message.error(message);    return imgArr  }}</script><style lang="scss">.box-send {  box-sizing: border-box;  &-title {    width: 100%;    display: flex;    align-items: center;    justify-content: space-between;    .ant-input {      width: 93%;      border-radius: 5px;      &-focus {        border-radius: 5px;      }    }    .ant-btn {      border-radius: 8px;    }  }  &-content {    margin: 20px 0;  }}</style>